{{= it.dots._header(it) }}
<main id="page">
	<div class="container">
		<h1>Bienvenue sur le book de {{= it.sanitize(it.user.pseudo) }}</h1>

		<p>Date d'inscription : {{= it.strftime("%d %B %Y", it.user.register_date) }}</p>
	
		{{? it.user.sex }}
		<div>
			Sexe : 
			{{ switch(it.user.sex) { }}
				{{ case 'male': }}
					Homme
				{{ break; }}
				{{ case 'female': }}
					Femme
				{{ break; }}
			{{ } }}
		</div>
		{{?}}
	
		{{? it.user.biography }}
		<div>{{= it.sanitize(it.user.biography) }}</div>
		{{?}}
	
		{{? it.user.geo_county }}
		<p>Département : {{= it.sanitize(it.user.geo_county._id + ' — '+ it.user.geo_county.name) }}</p>
		{{?}}
	
		{{? it.user.photo_styles && it.user.photo_styles.length }}
		<p>
			Style :
			{{ var photo_styles = []; }}
			{{~ it.user.photo_styles :style }}
				{{ switch(style) { }}
					{{ case 'fashion': }}
						{{ photo_styles.push('Mode'); }}
					{{ break; }}
					{{ case 'glamour': }}
						{{ photo_styles.push('Glamour'); }}
					{{ break; }}
					{{ case 'lingerie': }}
						{{ photo_styles.push('Lingerie'); }}
					{{ break; }}
					{{ case 'erotic': }}
						{{ photo_styles.push('Érotique'); }}
					{{ break; }}
					{{ case 'nude': }}
						{{ photo_styles.push('Nu'); }}
					{{ break; }}
				{{ } }}
			{{~}}
			{{= ' ' + photo_styles.join(', ') }}
		</p>
		{{?}}
	
		{{? it.user.photo_conditions }}
		<p>Conditions : {{= it.sanitize(it.user.photo_conditions) }}</p>
		{{?}}
		
		{{? it.albums.length }}
			<h2>Albums</h2>
			<ul class="albums-list">
			{{~ it.albums :album }}
				<li class="album">
					<h3 class="album-title"><a href="{{= it.app.url}}/book/{{= it.user.pseudo}}/{{= album._id}}">{{= it.sanitize(album.title) }}</a></h3>
					{{? album.description }}
					<blockquote class="album-description">
						{{= it.sanitize(album.description) }}
					</blockquote>
					{{?}}
					
					{{? album.photos && album.photos.length }}
						<h3 class="sr-only">Aperçu de l'album :</h3>
						<ul class="album-preview">
						{{~ album.photos.slice(0, 5) :photo }}
							<li>
								<a href="{{= it.app.url }}/book/{{= it.user.pseudo }}/{{= album._id }}#photo-{{= photo._id }}">
									<img src="{{= it.app.url }}/photos/{{= it.user._id + '/' + album._id + '/166x166x1/' + photo.src }}" alt="" />
								</a>
							</li>
						{{~}}
						</ul>
					{{??}}
						<p><em>Album vide</em></p>
					{{?}}
				</li>
			{{~}}
			</ul>
		{{??}}
			<p><em>{{= it.sanitize(it.user.pseudo) }}</em> n'a pas encore ajouté encore de photos à son book</p>
		{{?}}
		
		{{? it.current_user && it.user._id.equals(it.current_user._id) }}
		<form action="{{= it.app.url }}/nouvel-album" method="post">
			{{? it.form_error }}
				<p class="alert-error">{{= it.form_error }}</p>
			{{?}}
			<fieldset>
				<legend>Créer un album</legend>
				<div>
					<label for="new-album-title">Nom de l'album</label>
					<input type="text" name="album[title]" id="new-album-title" required size="12" maxlength="50" value="{{? it.req.body && it.req.body.album && it.req.body.album.title }}{{= it.req.body.album.title }}{{?}}" />
				</div>

				<div>
					<label for="new-album-description">Description <small class="field-indication">(facultative)</small></label>
					<textarea name="album[description]" id="new-album-description" cols="50" rows="4">{{? it.req.body && it.req.body.album && it.req.body.album.description }}{{= it.req.body.album.description }}{{?}}</textarea>
				</div>
			</fieldset>
			<div>
				<button type="submit">Créer</button>
			</div>
		</form>
		{{?}}
	</div>
</main>
{{= it.dots._footer(it) }}