{{= it.dots._header(it) }}
<main id="page">
	<div class="container">
		<h1>Bienvenue sur le book de {{= it.sanitize(it.user.pseudo) }}</h1>
	
		<div class="user-profile">
			<picture class="user-avatar">
				<source srcset="{{= it.app.url }}/avatar/140x140x1/{{= it.user._id }}" media="(max-width: 32em)" />
				<source srcset="{{= it.app.url }}/avatar/177x177x1/{{= it.user._id }}" media="(max-width: 40em)" />
				<source srcset="{{= it.app.url }}/avatar/182x182x1/{{= it.user._id }}" media="(max-width: 50em)" />
				<source srcset="{{= it.app.url }}/avatar/230x230x1/{{= it.user._id }}" media="(max-width: 60em)" />
				<source srcset="{{= it.app.url }}/avatar/278x278x1/{{= it.user._id }}" media="(max-width: 80em)" />
				<img srcset="{{= it.app.url }}/avatar/384x384x1/{{= it.user._id }}" alt="" />
			</picture>
			
			<div class="user-profile-content">

				{{? it.user.sex }}
				<p class="user-sex">
					Sexe&nbsp;: 
					{{ switch(it.user.sex) { }}
						{{ case 'male': }}
							Homme
						{{ break; }}
						{{ case 'female': }}
							Femme
						{{ break; }}
					{{ } }}
				</p>
				{{?}}
			
				{{? it.user.geo_county }}
				<p class="user-geo_county">Département&nbsp;: {{= it.sanitize(it.user.geo_county._id + ' — '+ it.user.geo_county.name) }}</p>
				{{?}}
			
				{{? it.user.biography }}
				<h2 class="sr-only">Biographie</h2>
				<blockquote class="user-biography">
					{{= it.sanitize(it.markdown_inline.render(it.user.biography)) }}
				</blockquote>
				{{?}}
			
				{{? it.user.camera_side }}
				<p class="user-camera_side">
					Côté de la caméra préféré&nbsp;: 
					{{ switch(it.user.camera_side) { }}
						{{ case 'photographer': }}
							Photographe
						{{ break; }}
						{{ case 'model': }}
							Modèle
						{{ break; }}
					{{ } }}
				</p>
				{{?}}
			
				{{? it.user.photo_styles && it.user.photo_styles.length }}
				<p class="user-photo_styles">
					{{ var photo_styles = []; }}
					{{~ it.user.photo_styles :style }}
						{{ switch(style) { }}
							{{ case 'fashion': }}
								{{ photo_styles.push('Mode'); }}
							{{ break; }}
							{{ case 'glamour': }}
								{{ photo_styles.push('Glamour'); }}
							{{ break; }}
							{{ case 'lingerie': }}
								{{ photo_styles.push('Lingerie'); }}
							{{ break; }}
							{{ case 'erotic': }}
								{{ photo_styles.push('Érotique'); }}
							{{ break; }}
							{{ case 'nude': }}
								{{ photo_styles.push('Nu'); }}
							{{ break; }}
						{{ } }}
					{{~}}
					{{= photo_styles.length > 1 ? 'Styles préféré' : 'Style préféré' }}&nbsp;:
					{{= ' ' + photo_styles.join(', ') }}
				</p>
				{{?}}
			
				{{? it.user.photo_conditions }}
				<h2 class="sr-only">Conditions</h2>
				<blockquote class="user-photo_conditions">
					{{= it.sanitize(it.markdown_inline.render(it.user.photo_conditions)) }}
				</blockquote>
				{{?}}

				<p class="user-register_date">Date d'inscription&nbsp;: {{= it.strftime("%d %B %Y", it.user.register_date) }}</p>
			</div>
		</div>

		{{? it.albums.length }}
			<h2>Albums</h2>
			<ul class="albums-list">
			{{~ it.albums :album }}
				<li class="album">
					<a href="{{= it.app.url}}/book/{{= it.user.pseudo}}/{{= album._id}}">
						<h3 class="album-title">{{= it.sanitize(album.title) }}</h3>
						{{? album.description }}
						<blockquote class="album-description">
							{{= it.sanitize(album.description) }}
						</blockquote>
						{{?}}
						
						{{? album.photos && album.photos.length }}
							<aside class="album-preview" role="presentation">
								<h3 class="sr-only">Aperçu de l'album :</h3>
								{{~ album.photos.slice(0, 5) :photo }}
								<span class="album-preview-thumb">
									<picture class="thumb">
										<source srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + album._id + '/74x74x1/' + photo.src }}" media="(max-width: 32em)" />
										<source srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + album._id + '/99x99x1/' + photo.src }}" media="(max-width: 40em)" />
										<source srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + album._id + '/102x102x1/' + photo.src }}" media="(max-width: 50em)" />
										<source srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + album._id + '/134x134x1/' + photo.src }}" media="(max-width: 60em)" />
										<source srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + album._id + '/166x166x1/' + photo.src }}" media="(max-width: 80em)" />
										<img srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + album._id + '/230x230x1/' + photo.src }}" alt="" />
									</picture>
								</span>
								{{~}}
							</aside>
						{{??}}
							<p><em>Album vide</em></p>
						{{?}}
					</a>
				</li>
			{{~}}
			</ul>
		{{??}}
			<p><em>{{= it.sanitize(it.user.pseudo) }}</em> n'a pas encore ajouté encore de photos à son book</p>
		{{?}}
		
		{{? it.current_user && it.user._id.equals(it.current_user._id) }}
		<form action="{{= it.app.url }}/nouvel-album#form-album" method="post" id="form-album">
			{{? it.form_error }}
				<p class="alert error">{{= it.form_error }}</p>
			{{?}}
			<fieldset>
				<legend>Créer un album</legend>
				<div>
					<label for="new-album-title">Nom de l'album</label>
					<input type="text" name="album[title]" id="new-album-title" required size="12" maxlength="50" value="{{? it.req.body && it.req.body.album && it.req.body.album.title }}{{= it.req.body.album.title }}{{?}}" />
				</div>

				<div>
					<label for="new-album-description">Description <small class="field-indication">(facultative)</small></label>
					<textarea name="album[description]" id="new-album-description" cols="50" rows="4">{{? it.req.body && it.req.body.album && it.req.body.album.description }}{{= it.req.body.album.description }}{{?}}</textarea>
				</div>
			</fieldset>
			<div>
				<button type="submit">Créer</button>
			</div>
		</form>
		{{?}}
	</div>
</main>
{{= it.dots._footer(it) }}