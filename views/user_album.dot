<main id="page">
	<div class="container">
		<h1 class="album-title">Album <strong>{{= it.sanitize(it.album.title) }}</strong> par <em>{{= it.sanitize(it.user.pseudo) }}</em></h1>
		
		{{? it.album.description }}
			<blockquote class="album-description">
				{{= it.sanitize(it.album.description) }}
			</blockquote>
		{{?}}
		{{? it.album.photos && it.album.photos.length }}
			<ul class="album-photos">
			{{~ it.album.photos :photo }}
				<li id="photo-{{= photo._id }}">
					<figure class="photo">
						<picture>
							<source srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + it.album._id + '/1920x1080/' + photo.src }}" media="(max-width: 1920px)" />
							<source srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + it.album._id + '/1280x720/' + photo.src }}" media="(max-width: 1280px)" />
							<source srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + it.album._id + '/1024x576/' + photo.src }}" media="(max-width: 1024px)" />
							<img srcset="{{= it.app.url }}/photos/{{= it.user._id + '/' + it.album._id + '/960x540/' + photo.src }}" alt="" />
						</picture>
						{{? photo.title }}
						<figcaption class="photo-caption">
							{{= it.sanitize(photo.title) }}
						</figcaption>
						{{?}}
					</figure>
				</li>
			{{~}}
			</ul>
		{{??}}
			<p><em>{{= it.sanitize(it.user.pseudo) }}</em> n'a pas ajouté encore de photos dans cet album</p>
		{{?}}

		{{? it.current_user && it.album.creator.equals(it.current_user._id) }}
		<form action="{{= it.app.url }}/book/{{= it.user.pseudo }}/{{= it.album._id}}" method="post" enctype="multipart/form-data">
			{{? it.form_error }}
				<p class="alert-error">{{= it.form_error }}</p>
			{{?}}
			<fieldset>
				<legend>Ajouter une photo</legend>
				<div>
					<label for="new-image-src">Fichier</label>
					<input type="file" name="image[src]" id="new-image-src" required data-drag-drop-area />
				</div>

				<div>
					<label for="new-image-title">Description</label>
					<input type="text" name="image[title]" id="new-image-title" maxlength="100" value="{{? it.req.body && it.req.body.image && it.req.body.image.title }}{{= it.req.body.image.title }}{{?}}" />
					<span class="field-indication">Champ facultatif. Décrivez la photo en quelques mots</span>
				</div>
			</fieldset>
			<div>
				<button type="submit">Ajouter</button>
			</div>
		</form>
		{{?}}
	</div>
</main>